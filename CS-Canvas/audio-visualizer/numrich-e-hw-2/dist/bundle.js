(()=>{"use strict";var e,t,n,o,r,a,c,i=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(o,")")},l=Object.freeze({gain:.5,numSamples:256}),u={enableTreble:!1,enableBass:!1},s=(new Uint8Array(l.numSamples/2),function(e){t.src=e});function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,v(o.key),o)}}function g(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!=d(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==d(t)?t:t+""}var m,b,p,S,w,q,T,k,M=g((function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;y(this,e),f(this,"update",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.x,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.y,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.width,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.height;t.x=e,t.y=n,t.width=o,t.height=r})),f(this,"draw",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"black",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"black";e.save(),e.fillStyle=n,e.translate(t.x,t.y),e.strokeStyle=o,e.fillRect(0,0,t.width,t.height),e.strokeRect(0,0,t.width,t.height),e.restore()})),this.x=n,this.y=o,this.width=r,this.height=a})),x=g((function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;y(this,e),f(this,"update",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.x,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.y,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.radius;t.x=e,t.y=n,t.radius=o})),f(this,"draw",(function(e,n,o,r,a){e.save(),e.fillStyle=a,e.translate(t.x,t.y),e.beginPath(),e.arc(0,0,t.radius,n,o,r),e.closePath(),e.fill(),e.restore()})),this.x=n,this.y=o,this.radius=r})),E={showBuildings:!0,showMoon:!0,enableDarkHour:!1,translateMoon:!1},L="frequency",A=Object.freeze({sound1:"media/Full Moon Full Life.mp3"}),F=function(n){var o=document.querySelector("#btn-play");document.querySelector("#btn-fs").onclick=function(e){var t;console.log("goFullscreen() called"),(t=n).requestFullscreen?t.requestFullscreen():t.mozRequestFullscreen?t.mozRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()},o.onclick=function(n){console.log("audioCtx.state before = ".concat(e.state)),"suspended"==e.state&&e.resume(),console.log("audioCtx.state after = ".concat(e.state)),"no"==n.target.dataset.playing?(t.play(),n.target.dataset.playing="yes"):(t.pause(),n.target.dataset.playing="no")};var i=document.querySelector("#slider-volume"),l=document.querySelector("#label-volume"),d=document.querySelector("#slider-speed"),h=document.querySelector("#label-speed");i.oninput=function(e){var t;t=e.target.value,t=Number(t),r.gain.value=t,l.innerHTML=Math.round(e.target.value/2*100)},i.dispatchEvent(new Event("input")),d.oninput=function(e){var t;t=e.target.value,q=Number(t),h.innerHTML=Math.round(1e4*e.target.value)},d.dispatchEvent(new Event("input"));var g=document.querySelector("#select-track"),y=document.querySelector("#data-type");g.onchange=function(e){s(e.target.value),"yes"==o.dataset.playing&&o.dispatchEvent(new MouseEvent("click"))},y.onchange=function(e){L=e.target.value},document.querySelector("#cb-buildings").addEventListener("change",(function(){return E.showBuildings=document.querySelector("#cb-buildings").checked})),document.querySelector("#cb-moon").addEventListener("change",(function(){return E.showMoon=document.querySelector("#cb-moon").checked})),document.querySelector("#cb-darkhour").addEventListener("change",(function(){return E.enableDarkHour=document.querySelector("#cb-darkhour").checked})),document.querySelector("#cb-translate").addEventListener("change",(function(){return E.translateMoon=document.querySelector("#cb-translate").checked})),document.querySelector("#cb-treble").addEventListener("change",(function(){u.enableTreble=document.querySelector("#cb-treble").checked,u.enableTreble?(a.frequency.setValueAtTime(1e3,e.currentTime),a.gain.setValueAtTime(25,e.currentTime)):a.gain.setValueAtTime(0,e.currentTime)})),document.querySelector("#cb-bass").addEventListener("change",(function(){u.enableBass=document.querySelector("#cb-bass").checked,u.enableBass?(c.frequency.setValueAtTime(1e3,e.currentTime),c.gain.setValueAtTime(15,e.currentTime)):c.gain.setValueAtTime(0,e.currentTime)}))},H=function e(){setTimeout(e,1e3/60),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"frequency"==(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"frequency")?S.getByteFrequencyData(w):S.getByteTimeDomainData(w),m.save(),e.enableDarkHour?(m.fillStyle="rgba(21, 107, 0, 1)",document.querySelector("body").style.color="lime"):(m.fillStyle="rgba(0, 83, 157, 1)",document.querySelector("body").style.color="aqua"),m.globalAlpha=.1,m.fillRect(0,0,b,p),m.restore();var t=new x(.85*b,.25*p);if(e.showMoon){var n=p/4;m.save(),m.globalAlpha=.5;for(var o=0;o<w.length;o++){var r=w[o]/255,a=r*n;t.update(b/2,p/2,a),e.translateMoon?(t.update(t.x+530*Math.cos(k-q*T),t.y+150*Math.sin(k-q*T),a),t.draw(m,0,2*Math.PI,!0,i(250,222,120,.34-r/3))):(t.update(.85*b,.25*p),t.draw(m,0,2*Math.PI,!0,i(250,222,120,.34-r/3)),T=0)}m.restore(),t.x<-n-20?T=0:T++}if(e.showBuildings){for(var c=1,l=4,u=35,s=200,d=70,h=new M,g=0,y=0;y<w.length;y++)y%6==0&&(h.update(l+g*(u+c),d+256-w[y],u,s),h.draw(m,"rgba(74, 74, 74, 1)","rgba(74, 74, 74, 0.7)"),g++);c=1,l=4,u=60,s=200,d=125,new M,g=0;for(var f=0;f<w.length;f++)f%10==0&&(h.update(l+g*(u+c),d+256-w[f],u,s),h.draw(m,"rgba(0, 0, 0, 1)","rgba(68, 68, 68, 0.7)"),g++)}}(E,L)};window.onload=function(){console.log("window.onload called"),function(){var i,u;console.log("init called"),i=A.sound1,u=window.AudioContext||window.webkitAudioContext,e=new u,t=new Audio,s(i),n=e.createMediaElementSource(t),(o=e.createAnalyser()).fftSize=l.numSamples,(r=e.createGain()).gain.value=l.gain,a=e.createBiquadFilter(),c=e.createBiquadFilter(),a.type="highshelf",c.type="lowshelf",n.connect(o),o.connect(r),r.connect(c),c.connect(a),a.connect(e.destination);var d=document.querySelector("canvas");F(d);var h=new XMLHttpRequest;h.onload=function(e){console.log("In onload - HTTP Status Code = ".concat(e.target.status));var t=e.target.responseText,n=JSON.parse(t),o=n.title;document.querySelector("title").innerHTML=o,document.querySelector("#title").innerHTML=o;for(var r=n.directory,a=n.tracklist,c=n.directions.map((function(e){return"".concat(e)})).join("<br>"),i='<option value="'.concat(r[0],'">').concat(a[0],"</option>"),l=1;l<a.length;l++)i+='<option value="'.concat(r[l],'">').concat(a[l],"</option>");document.querySelector("#select-track").innerHTML=i,document.querySelector("#directions").innerHTML+=c,console.log("Loading Complete")},h.onerror=function(e){return console.log("In onerror - HTTP Status Code = ".concat(e.target.status))},h.open("GET","data/av-data.json"),h.send(),function(e,t){m=e.getContext("2d"),b=e.width,p=e.height,S=t,w=new Uint8Array(S.fftSize/2),T=0,k=50}(d,o),H()}()}})();